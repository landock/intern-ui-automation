= Custom Command Methods

== BaseCommand

setAllTimeoutLengths(timeoutLength)::
====
This sets various timeouts. It is equivalent to: 

[source,javascript]
    .setTimeout('script', defaultTimeoutLength)
    .setTimeout('page load', defaultTimeoutLength)
    .setFindTimeout(findTimeoutLength);

NOTE: This method is an internal helper method for configureNewSession

[horizontal]
.Parameters
timeoutLength:: The amount of time the various timeouts should be set to (ms)
====



configureNewSession(timeout)::
====
This is used in tests to consolidate common setup parameters. It is equivalent to: 

[source,javascript]
    .setAllTimeoutLengths(timeout)
    .clearCookies();

Use it in the setup function of tests. For example:

[source,javascript]
    ... 
    return {
        name: 'non-logged in customer can add a coupon code',
        setup: function() {
            command = new Command(this.remote);
            couponCode = generator.getPromoCode('Anybody',0);
            return command
            .configureNewSession(60000)
            .get(config.URL + '/lens/biofinity');
        },
        ...
    }
    ...

[horizontal]
.Parameters
timeout:: The amount of time the various timeouts should be set to (ms)
====



configureNewMobileSession(timeout)::
====
This is used in tests to consolidate common setup parameters for mobile tests. It is equivalent to: 

[source,javascript]
    .configureNewSession(timeout)
    .mobileClearAppAdPage()
    .removeDemandWareWidget();


Use it in the setup function of mobile tests. For example:

[source,javascript]
    return {
        name: 'mobile address editing test',
        setup : function() {
            customer = generator.getRandomCustomer();
            anotherRandomCustomer = generator.getRandomCustomer();
            command = new Command(this.remote);
            return command
            .configureNewMobileSession(60000)
            .get(config.URL + '/account');
        },
        ...
    }
    ...


[horizontal]
.Parameters
timeout:: The amount of time the various timeouts should be set to (ms)
====



loginFromHeader(customer)::
====
Consolidates commands to log a customer in using the drop-down menu in the header of the 1800Contacts website.

[horizontal]
.Parameters
customer:: A customer object representing the custoer to be logged in (typically from `generator.js`) 
====



logoutFromHeader()::
====
Consolidates commands to log a customer out using the drop-down menu in the header.

CAUTION: This method will fail if called when no customer is logged in
====



mobileLogin(customer)::
====
Consolidates commands to log a customer in on mobile platforms.

[horizontal]
.Parameters
customer:: A customer object representing the custoer to be logged in (typically from `generator.js`) 
====



mobileLogout()::
====
Consolidates commands to log a customer out on mobile platforms.

CAUTION: This method will fail if called when no customer is logged in
====



signInFromCart(customer)::
====
Consolidates commands to sign a customer in when prompted during the checkout process.

NOTE: This method has to be called when the test is on the page prompting for login during the checkout process or else it will fail.

[horizontal]
.Parameters
customer:: A customer object representing the custoer to be logged in (typically from `generator.js`) 
====



assertLoggedIn()::
====
Asserts that a user is logged in. Fails if they are not logged in.
====



assertLoggedOut()::
====
Asserts that a user is not logged in (logged out). Fails if they are still logged in.
====



enterInput(id, text)::
====
Enters text into a form text input. This method encapsulates extra functionality that leadfoot's `.type()` doesn't have which handles the clearing of default placeholder text on the 1800Contacts site. 

CAUTION: This only works for pages that have JQuery loaded

[horizontal]
.Parameters
id:: The CSS selector of the form input element to receieve the text 
text:: The text to enter into the form input element specified by `id` 
====



enterInputWithoutJQuery(id, text)::
====
Enters text into a form text input. This is intended for use with external pages (i.e. PayPal, FaceBook sign-ins) which do not use JQuery. For 1800Contacts page inputs, use `enterInput` instead.

[horizontal]
.Parameters
id:: The CSS selector of the form input element to receieve the text 
text:: The text to enter into the form input element specified by `id` 
====



setDesktopPowerDropdown(id, value)::
====
Sets the eye power on contacts product pages. Use this instead of `setDropdown` for the eye power dropdown since it contains additional logic to handle the custom dual-column dropdown for eye power used on the desktop 1800Contacts site.

NOTE: To set the power dropdown on mobile pages, use `setDropdown`

.Example
[source,javascript]
----
.setDesktopPowerDropdown('#dwfrm_lensproduct_rightEye_contactsPower','+1.25')
----

[horizontal]
.Parameters
id:: The id of the HTML `select` element that corresponds to the power dropdown
value:: The value which the dropdown should be set to.
====



setDropdown(id, value)::
====
A convenience method to set dropdown (select) elements. Use this for any dropdown on mobile pages and any dropdown on desktop pages (except for the desktop eye power select dropdown).

NOTE: To set the eye power dropdown on the desktop site, use `setDesktopPowerDropdown`

.Example
[source,javascript]
----
.setDropdown('#CreditCardChoose','newCreditCard')
----

[horizontal]
.Parameters
id:: The id of the HTML `select` element that corresponds to the dropdown
value:: The value which the dropdown should be set to. This corresponds to the `value` attribute of the HTML `<option>` tag.
====



findAndClick(id)::
====
A convenience method that combines leadfoot's `.findAllByCssSelector` method and leadfoot's `.click` method. 

[horizontal]
.Parameters
id:: The id of the HTML element to be clicked on.
====



clearForm(formId)::
====
A convenience method that clears all HTML `<input>` elements of a form with the type attributes of `type=text` and `type=tel`.

[horizontal]
.Parameters
formId:: The id of the HTML `<form>` element containing `<input>` elements to be cleared.
====



assertElementText(selector, text)::
====
A convenience method that finds an element, then asserts that its text includes the text given in the `text` argument.

NOTE: This method uses the `assert.include` method of chai JS.

[horizontal]
.Parameters
selector:: The id of the element which contains the text to be asserted.
text:: A sample of text that the element given by `selector` should containe
====



removeDemandWareWidget()::
====
This method removes the DemandWare widget present on pages in the staging environment. This is particularly useful in the mobile tests where the widget interferes with other common page elements.
====



createNewAccount(customer)::
====
A convenience method that consolidates commands to create a new account from the `/account` page.

CAUTION: This command has to be run from the `/account` page. Use leadfoot's `get` command to direct the browser to the `/account` page if not already on it before calling this command.

.Example
[source,javascript]
----
...
return {
    name: 'new logged-in customer can change doctor during checkout',
    setup: function() {
        command = new Command(this.remote);
        customer = generator.getRandomCustomer();
        return command
        .configureNewSession(60000)
        .get(config.URL + '/account'); <1>
    },

    'create new account': function(){
        return command
        .createNewAccount(customer);
    },
    ...
}
----
<1> Note that this test starts on `/account` before calling `createNewAccount`

[horizontal]
.Parameters
customer:: A customer object (typcially retrieved from `generator.js`) representing the new customer to be created.
====



mobileClearAppAdPage()::
====
A convenience method that clears the survey pop-up box on the mobile site by clicking 'No Thanks' if it exists.
====



clickOnStylizedFormElement(label_id)::
====
A method that encapsulates functionality to handle stylized radio buttons and checkboxes used throughout the site. These stylized controls hide the HTML element and use JavaScript and images to mimic their functionality. This method provides an easy way to click on these stylized form elements which works on all browsers.

[horizontal]
.Parameters
label_id:: The CSS ID of the HTML `<label>` element that corresponds to the hidden `<input>` radio button or checkbox which should receive the click.
====



assertOrderSuccess()::
====
Asserts that an order has been placed successfully by asserting the presence of the HTML element that contains the confirmation message.
====



== AddressCommand

fillAddressForm(customer)::
====
Fills out all fields in the address form including:

* address 1
* address 2
* city
* zip
* phone
* firstname
* lastname
* state

This method can be used on its own, but is more typically used as a 'helper' method for the other methods in `AddressCommand.js` such as `fillCartAddressForm`, `fillEditAddressForm`, and `fillAddNewAddressForm`.

NOTE: If an address form is not present on the page, this method will fail

[horizontal]
.Parameters
customer:: A customer object representing customer data to be used when populating the form fields (typically from `generator.js`).
====



fillCartAddressForm(customer)::
====
Fills out an address form by calling `fillAddressForm` and in addition, fills out the following additional fields present on the adress form when accessed from the cart:

* email
* password
* passwordconfirm

NOTE: If an address form is not present on the page, this method will fail

[horizontal]
.Parameters
customer:: A customer object representing customer data to be used when populating the form fields (typically from `generator.js`).
====



fillEditAddressForm(customer)::
====
This method is used when editing an address in the Account section of the site. It Ensures the address form is cleared and then fills out an address form by calling `fillAddressForm`. This method also clicks the edit address submit button when finished and ensures that the address form dialog closes when finished. 

NOTE: If an address form is not present on the page, this method will fail

[horizontal]
.Parameters
customer:: A customer object representing customer data to be used when populating the form fields (typically from `generator.js`).
====



fillAddNewAddressForm(customer)::
====
This method is used when adding a new address in the Account section of the site. It Ensures the address form is cleared and then fills out an address form by calling `fillAddressForm`. This method also clicks the new address submit button when finished and ensures that the address form dialog closes when finished. 

NOTE: If an address form is not present on the page, this method will fail

[horizontal]
.Parameters
customer:: A customer object representing customer data to be used when populating the form fields (typically from `generator.js`).
====



== DrCommand

fillDrInfo(customer)::
====
Fills out the Dr. info during the ordering process. It enters the Doctor name and state specified in the customer object and then clicks on the search button. Once the results are returned, the first result is selected. This results in moving on to the next page in the order process once this method has finished running.

[horizontal]
.Parameters
customer:: A customer object representing customer data to be used when populating the Dr. search form fields (typically from `generator.js`).
====



mobileFillDrInfo(customer)::
====
Fills out the Dr. info during the ordering process on the mobile site. It enters the Doctor name and state specified in the customer object and then clicks on the search button. Once the results are returned, the first result is selected. This results in moving on to the next page in the order process once this method has finished running.

[horizontal]
.Parameters
customer:: A customer object representing customer data to be used when populating the Dr. search form fields (typically from `generator.js`).
====



== HomeCommand

loginFromHome(customer)::
====
Logs into the site using the button on the Home page (not the sign-in link in the header).

NOTE: To log in to the site from any page using the sign-in link in the header, use the `loginFromHeader(customer)` custom command (defined in `BaseCommand.js`.

[horizontal]
.Parameters
customer:: A customer object representing the customer to log in (typically from `generator.js`).
====



== PaymentCommand

testCardPayment(customer, creditCardNo)::
====
This method encapsulates functionality used in multiple payment method tests. It must be run from the `/account` page since it creates a new account. This method performs the following:

* creates a new account
* assert that login with new account is successful
* places contact lenses in the cart
* fills out a new address for the new customer
* fills out Dr. info
* clicks on the CreditCard method of payment
* chooses a new CreditCard as the payment method
* enters the credit card number passed in from the `creditCardNo` argument to this method
* enters the credit card year
* enters the customer name
* submits the order

CAUTION: This command has to be run from the `/account` page. Use leadfoot's `get` command to direct the browser to the `/account` page if not already on it before calling this command.

[horizontal]
.Parameters
customer:: A customer object representing the new customer to create and use to perform these actions (typically from `generator.js`).
creditCardNo:: The test credit card number to use to place the test order (typcially retrieved from `generator.js`).
====



mobileTestCardPayment(customer, creditCardNo)::
====
This method encapsulates functionality used in multiple payment method tests. It must be run from the `/lens/acuvue-oasys-24` page.

* places contact lenses in the cart
* fills out Dr. info
* clicks on the CreditCard method of payment
* chooses a new CreditCard as the payment method
* enters the credit card number passed in from the `creditCardNo` argument to this method
* enters the credit card year
* enters the customer name
* submits the order

CAUTION: This command has to be run from the `/lens/acuvue-oasys-24` page. Use leadfoot's `get` command to direct the browser to the `/lens/acuvue-oasys-24` page if not already on it before calling this command.

[horizontal]
.Parameters
customer:: A customer object representing the new customer to create and use to perform these actions (typically from `generator.js`).
creditCardNo:: The test credit card number to use to place the test order (typcially retrieved from `generator.js`).
====




